= Step 3. Develop the API
ifndef::env-site,env-github[]
include::_attributes.adoc[]
endif::[]

You've created an API specification. Use it to create the API.
In MuleSoft, developers will package an API in an application that is deployed to a Mule runtime engine (Mule)
in one of several environments, called targets.
When you use Studio, you can build, test, and deploy to an embedded Mule in Studio.
Using Studio in this way ensures that your API works as you expect before deploying it to its final destination (target).

. Import the API specification that you created. Studio provides automated scaffolding to help you complete the API.
. Build business logic into your API.
. Add unit tests and test the API, all from Studio.

image:empty-studio.png[]

<1> The Package Explorer helps you navigate the files created for each project.
<2> The canvas is where you drag and drop elements of your project and connect them, creating a flow.
<3> The Mule Palette provides quick access to standard or custom assets such as connectors and modules.
<4> The tabs in the bottom section provide access to configuration dialogs, the Mule debugger, and other developer dialogs.

=== Step 1: Add Your Anypoint Platform Credentials to Studio

Add your Anypoint Platform credentials in Studio once, and they'll be available for all the projects you create.

. Open Studio, and then click *Anypoint Studio > Preferences*.
. Select *Anypoint Studio > Authentication*.
. Enter your Anypoint Platform username and password.
. Optionally, enter a duration in days for how long this authentication is valid.
. Click *Sign in*.
. Click *Apply and Close*.

These credentials are automatically used for many operations in Studio.

=== Step 2: Create a New Studio Project with an Imported API Specification

In this step, we'll create the project.

. In Studio, select *File > New > Mule Project*.
. In the dialog box, provide the following values:
  ** *Project Name*: `hello-world`
  ** *Runtime*: If there is a choice, select the latest version of Mule. This is the Mule runtime engine that is hosted within Studio for testing.
  ** Select the *From Design Center or local files* tab.
    ... Click the button to the right of the *Location* field.
    ... Select *Design Center* to display a list of API specifications created in your organization.
    ... Select *hello-world*.
    ... Click *OK*.
. Verify that the checkbox *Scaffold flows from these API specifications* is selected. This ensures that Studio will add default error handling and other helpful items to your project.
. Click *Finish*.
. To verify the import, look in *Package Explorer > hello-world > src/main/resources > api*. This folder should contain the file `hello-world.raml`, which is the specification file you created and imported into the project.

To open the project file, open *Package Explorer > hello-world > src/main/mule*, and then double-click `hello-world.xml`.
Studio opens the `hello-world.xml` XML file in the canvas *Message Flow* view,
displaying some of the basic elements you'll need for the API interface:

image:my-first-project.png[]

Notice that there are three different views of the canvas:

image:canvas-tabs.png[]

* *Message Flow* view makes it easy to drag and drop modules, connectors, and other assets and create the relationships between them.
* *Global Elements* view makes it easy to specify global elements used in multiple projects.
* *Configuration XML* view makes it easy to edit the XML of a project directly. 

//The scaffolding provides tools that we won't use in this tutorial, so delete the unnecessary elements:
//
//. Right-click on *APIkit Router* and select *Delete*.
//. Right-click on each error handler except *APIKIT:BAD_REQUEST*, and select *Delete*.
//. Right-click on *hello-world-console* and select *Delete*.
//
In the next step, we'll create business logic and configure the elements we need for this API.

=== Step 3: Configure the API

Using the scaffolding provided by Studio, complete the API:

. In Studio, configure the listener:
  .. In the canvas, click the *hello-world-main* listener to display the *General* configuration tab below the canvas.
  .. In *Basic Settings > Connector configuration* you can see the configuration *hello-world-httpListenerConfig* has been created for you.
  .. Click the edit icon next to the configuration name, and verify that the host is `0.0.0.0` and the port is `8081`, and then close the configuration.
  .. Leave *Path* as */api/**. This best practice ensures that all endpoints will be of the form `base-URI/api/endpoint`.
  .. Save your changes.
  .. Click *Test Connection*, and then click *OK* when a successful test connection is reported.
  .. Click *OK* to close the dialog.
  .. Click *Global Elements* at the bottom of the canvas. Notice that this configuration is a global configuration and can be used in more than one API.
  .. Click *Configuration XML* at the bottom of the canvas to see the XML that has been created as a result of our work in the user interface.
. Specify the logic that displays the data sent in a response from hello-world API:
  .. In the *Mule Palette*, select *Favorites* or *Core* to display the *Set Payload* transformer.
  .. Find and drag *Set Payload* into the flow and leave it selected. Drag it to the right of *APIkit Router* but inside the lines that define the flow. +
     image:set-payload.png[]
  .. Below the canvas, in the *General* tab, click the *fx* (function) button to deselect it. For this simple exercise, we are hard-coding the value.
  .. Set *Value* under *Settings* to *Today the greeting is Hello.*
. Save your work by selecting *File > Save All*.
. Click *Configuration XML* at the bottom of the canvas to review the XML generated by your work.
. Click *Message Flow* to set the canvas for the next step.

You have created a project that contains a simple Mule app which you can deploy to expose your API.

[NOTE]
====
This API has been simplified compared to a typical production-ready API:
* The payload (what's delivered by the GET request) is hard coded in the project configuration. In a production-ready API the payload value would typically come from another source.
* The best practice of separating the interface and implementation (business logic) into separate XML files has been skipped for the sake of brevity.
====

=== Step 4. Test the API

Run the Studio project that contains your API in the Mule runtime engine and then test with a third-party client:

. Right-click anywhere on the canvas and select *Run project hello-world*.
+
The console opens and displays status messages as the app is deployed to the Mule runtime engine (Mule) contained within Studio.
When the following message is displayed, the app containing your API has been deployed to Mule:
+
----
*******************************************************************************************************
*            - - + APPLICATION + - -            *       - - + DOMAIN + - -       * - - + STATUS + - - *
*******************************************************************************************************
* hello-world                                   * default                        * DEPLOYED           *
*******************************************************************************************************
----    
. To test the app, open a REST client (Advanced Rest Client) and issue a GET request:
+
`\http://localhost:8081/api/greeting`
+
Your REST client should return a `200 OK` message and the body `Today the greeting is Hello.`.
. Right-click in the canvas and select *Stop project hello-word*.

=== Step 5. Create a Business Group in Your Organization

Before you can publish your API to Exchange to share it with others, you must create a Business Group in your trial organization.
Assets in Exchange must belong to a Business Group in order to manage access properly.

If you've already created a business group in your organization, you can skip this step.

To create a Business Group:

. Log in to Anypoint Platform.
+
link:https://anypoint.mulesoft.com/login/#/signup["Take me to Anypoint Platform^", role="button-primary"]
. Find *Management Center* on the landing page and underneath it, click *Access Management*.
. Click *Add Business Group* and enter these values:
  ** *Business Group name*: `My Top Business Group`
  ** *Owner*: Search for your name and select it.
  ** Select *Owner can create environment*.
  ** Leave the default for all other values.
. Click *Add Business Group*.

Your new business group is listed underneath the organization name in the Access Management screen.

=== Step 6. Publish the API to Exchange

Publish the API to Exchange so it can serve as a template or example for others.

. From the Package Explorer in Studio, right-click the `hello-world` project.
. Select *Anypoint Platform > Publish to Exchange*.
. For *User*, select your name.
. For *Business group*, select the business group you created, *My Top Business Group*. If your credentials have expired, click *Add account* to add them again.
. Leave *Version* as *1.0.0*.
. Select *Project type > Example*. The *Finish* button is now enabled.
. Click *Finish*.
. Click *Yes* when asked to proceed.
+
After the project is uploaded to Exchange, you are provided with a direct link to the project.
. Click the link to view the project in Exchange.
+
image:published-in-exchange.png[]

. You can add documentation, descriptions, and tags that aid search.
. Notice that HTTP Connector and Sockets Connector are listed as dependencies.
. When you are satisfied with the publication, return to Studio and click *OK* to close the open dialog windows.

== What's Next

To finish developing the API, you will add:

* Validation
* Event logging to support debugging
* Error handling
* A unit test to your API

== Developer Deep Dive

To explore some of the capabilities of Anypoint Platform and Studio:

* Transform data with DataWeave: xref:mule-runtime::dataweave-quickstart.adoc[Quickstart], xref:mule-runtime::mule-app-tutorial.adoc[Tutorial].
* Structure Mule applications using xref:mule-runtime::about-flows.adoc[flows, subflows, and asynchronous queues].
* Define and manage application metadata (schemas): xref:studio::metadata-editor-concept.adoc[Metadata Editor].
* Implement key-performance indicators using xref:api-manager::analytics-landing-page.adoc[API Manager analytics].
* Conditionally route events: xref:mule-runtime::choice-router-concept.adoc[choice router], xref:mule-runtime::scatter-gather-concept.adoc[scatter gather router].
